<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>Player.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Cst316</a> &gt; <a href="index.source.html" class="el_package">cst316</a> &gt; <span class="el_source">Player.java</span></div><h1>Player.java</h1><pre class="source lang-java linenums">/**
 * Description: This class's purpose is to store player's data and
 * be able to retrieve or manipulate any field using the given methods.
 * This class supports exporting and importing JSON files as a saving/loading feature.
 * 
 * Note: When importing the JSON data, be sure to prompt a player for their name.
 * The &quot;load&quot; method is dependent on knowing the name of the JSON file.
 * 
 * @author  Daniel Tracy
 * @version 1.0
 */
package cst316;

import java.io.File;
import java.io.FileReader;
import java.io.PrintWriter;
import java.util.ArrayList;
import java.util.List;

import org.json.JSONArray;
import org.json.JSONObject;
import org.json.JSONString;
import org.json.JSONTokener;

public class Player implements JSONString {
	
	private int points;
	private int employees;
	private double money;
	private String name;
	private ArrayList&lt;String&gt; assets;
	private ArrayList&lt;Investment&gt; investments;
	private ArrayList&lt;Building&gt; buildings;
	private Product product;
	
	/**
	 * Default construction of a player
	 */
<span class="fc" id="L39">	public Player() {</span>
<span class="fc" id="L40">		this.setPoints(0);</span>
<span class="fc" id="L41">		this.setMoney(0.0);</span>
<span class="fc" id="L42">		this.setEmployees(0);</span>
<span class="fc" id="L43">		this.setName(&quot;noname&quot;);</span>
<span class="fc" id="L44">		this.assets = new ArrayList&lt;String&gt;();</span>
<span class="fc" id="L45">		this.investments = new ArrayList&lt;Investment&gt;();</span>
<span class="fc" id="L46">		this.buildings = new ArrayList&lt;Building&gt;();</span>
<span class="fc" id="L47">	}</span>
	/**
	 * @param points
	 * @param employees
	 * @param money
	 * @param name
	 * @param assets
	 */
<span class="fc" id="L55">	public Player(int points, double money, String name, ArrayList&lt;String&gt; assets) {</span>
<span class="fc" id="L56">		this.setPoints(points);</span>
<span class="fc" id="L57">		this.setEmployees(employees);</span>
<span class="fc" id="L58">		this.setMoney(money);</span>
<span class="fc" id="L59">		this.setName(name);</span>
<span class="fc" id="L60">		this.setAssets(assets);</span>
<span class="fc" id="L61">		this.investments = new ArrayList&lt;Investment&gt;();</span>
<span class="fc" id="L62">		this.buildings = new ArrayList&lt;Building&gt;();</span>
<span class="fc" id="L63">	}</span>
	/**
	 * Initialize a player class
	 * @param points
	 * @param money
	 * @param name
	 * @param assets
	 */

<span class="nc" id="L72">	public Player(int points, int employees, double money, String name, ArrayList&lt;String&gt; assets) {</span>
<span class="nc" id="L73">		this.setPoints(points);</span>
<span class="nc" id="L74">		this.setEmployees(employees);</span>
<span class="nc" id="L75">		this.setMoney(money);</span>
<span class="nc" id="L76">		this.setName(name);</span>
<span class="nc" id="L77">		this.setAssets(assets);</span>
<span class="nc" id="L78">		this.investments = new ArrayList&lt;Investment&gt;();</span>
<span class="nc" id="L79">		this.buildings = new ArrayList&lt;Building&gt;();</span>
<span class="nc" id="L80">	}</span>
	
	/**
	 * Construct a player from a JSONObject
	 */
<span class="fc" id="L85">	public Player(JSONObject jsonObject) throws Exception {</span>
<span class="fc" id="L86">		this.setFromJSONObject(jsonObject);</span>
<span class="fc" id="L87">	}</span>
	
	private static String getJSONFilePath(String playerName) {
<span class="fc" id="L90">		StringBuilder retVal = new StringBuilder();</span>
<span class="pc bpc" id="L91" title="1 of 2 branches missed.">		if (System.getProperty(&quot;os.name&quot;).startsWith(&quot;Windows&quot;)) {</span>
<span class="fc" id="L92">			retVal.append(System.getenv(&quot;USERPROFILE&quot;));</span>
<span class="fc" id="L93">			retVal.append(&quot;\\Enterpreneurship Simulator\\&quot;);</span>
<span class="fc" id="L94">		} else {</span>
<span class="nc" id="L95">			retVal.append(System.getenv(&quot;HOME&quot;));</span>
<span class="nc" id="L96">			retVal.append(&quot;/.enterpreneurship-simulator/&quot;);</span>
		}
<span class="fc" id="L98">		File directory = new File(retVal.toString()); </span>
<span class="pc bpc" id="L99" title="1 of 2 branches missed.">		if (!directory.exists()) {</span>
<span class="nc" id="L100">			directory.mkdir();</span>
			
		}
<span class="pc bpc" id="L103" title="1 of 2 branches missed.">		if (playerName != null) {</span>
<span class="pc bpc" id="L104" title="2 of 6 branches missed.">			if (playerName.indexOf(&quot;.&quot;) != -1 || playerName.indexOf(&quot;/&quot;) != -1 || playerName.indexOf(&quot;\\&quot;) != -1) {</span>
<span class="fc" id="L105">				throw new IllegalArgumentException(&quot;Invalid Player Name&quot;);</span>
			}
<span class="fc" id="L107">			retVal.append(playerName);</span>
<span class="fc" id="L108">			retVal.append(&quot;.json&quot;);</span>
		}
<span class="fc" id="L110">		return retVal.toString();</span>
	}
	
	public static List&lt;String&gt; getAvailablePlayers() {
<span class="nc" id="L114">		File directory = new File(getJSONFilePath(null));</span>
<span class="nc" id="L115">		ArrayList&lt;String&gt; retVal = new ArrayList&lt;&gt;();</span>
<span class="nc bnc" id="L116" title="All 2 branches missed.">		for (File file : directory.listFiles()) {</span>
<span class="nc bnc" id="L117" title="All 2 branches missed.">			if (file.isFile()) {</span>
<span class="nc" id="L118">				String[] parts = file.getName().split(&quot;\\.&quot;);</span>
<span class="nc bnc" id="L119" title="All 4 branches missed.">				if (parts.length == 2 &amp;&amp; parts[1].equals(&quot;json&quot;)) {</span>
<span class="nc" id="L120">					retVal.add(parts[0]);</span>
				}
			}
		}
<span class="nc" id="L124">		return retVal;</span>
	}
	
	/**
	 * Makes a JSON string of the player data
	 * @return ret 
	 */
	public String toJSONString() {
<span class="fc" id="L132">		String ret = &quot;&quot;;</span>
		try {
			//Add the class fields to a JSON object
<span class="fc" id="L135">			JSONObject obj = new JSONObject();</span>
<span class="fc" id="L136">			obj.put(&quot;Points&quot;, points);</span>
<span class="fc" id="L137">			obj.put(&quot;Employees&quot;, employees);</span>
<span class="fc" id="L138">			obj.put(&quot;Money&quot;, money);</span>
<span class="fc" id="L139">			obj.put(&quot;Name&quot;, name);</span>
<span class="fc" id="L140">			obj.put(&quot;Assets&quot;, assets);</span>
<span class="fc" id="L141">			obj.put(&quot;Investments&quot;, investments);</span>
<span class="fc" id="L142">			obj.put(&quot;Buildings&quot;, buildings);</span>
<span class="fc" id="L143">			obj.put(&quot;Product&quot;, product);</span>
<span class="fc" id="L144">			ret = obj.toString();</span>
<span class="pc" id="L145">		} catch(Exception e) {</span>
<span class="nc" id="L146">			System.out.println(&quot;Failed to parse.&quot;);</span>
		}
<span class="fc" id="L148">		return ret; //Return the JSON string</span>
	}
	
	/**
	 * Saves the player's data to a JSON file
	 */
	public boolean saveFile() {
		try {
<span class="fc" id="L156">			PrintWriter out = new PrintWriter(getJSONFilePath(name));</span>
<span class="fc" id="L157">			out.println(toJSONString());</span>
<span class="fc" id="L158">			out.close();</span>
<span class="fc" id="L159">			return true;</span>
<span class="fc" id="L160">		} catch(Exception e) {</span>
<span class="fc" id="L161">			System.out.println(&quot;Failed to write.&quot;);</span>
		}
<span class="fc" id="L163">		return false;</span>
	}
	
	public void setFromJSONObject(JSONObject jsonObject) throws Exception {
		
		//Extract the data from the JSON file and store it into objects
<span class="fc" id="L169">		int points = jsonObject.getInt(&quot;Points&quot;);</span>
<span class="fc" id="L170">		int employees = jsonObject.getInt(&quot;Employees&quot;);</span>
<span class="fc" id="L171">		double money = jsonObject.getDouble(&quot;Money&quot;);</span>
<span class="fc" id="L172">		String name = jsonObject.getString(&quot;Name&quot;);</span>
<span class="fc bfc" id="L173" title="All 2 branches covered.">		if (!jsonObject.isNull(&quot;Product&quot;)) {</span>
<span class="fc" id="L174">			JSONObject productObject = jsonObject.getJSONObject(&quot;Product&quot;);</span>
<span class="fc" id="L175">			this.product = new Product(productObject);</span>
<span class="fc" id="L176">		} else {</span>
<span class="fc" id="L177">			this.product = null;</span>
		}
		
		//Get the list that is included in the JSON file
<span class="fc" id="L181">		JSONArray jArrayAssets = jsonObject.getJSONArray(&quot;Assets&quot;);</span>
<span class="fc" id="L182">		ArrayList&lt;String&gt; assets = new ArrayList&lt;String&gt;(); </span>
		
		//Populate the list with the JSON array values
<span class="fc bfc" id="L185" title="All 2 branches covered.">		for(int i = 0; i &lt; jArrayAssets.length(); i++) {</span>
<span class="fc" id="L186">			assets.add(jArrayAssets.getString(i));</span>
		}
		
		//Get the list that is included in the JSON file
<span class="fc" id="L190">		JSONArray jArrayInvestments = jsonObject.getJSONArray(&quot;Investments&quot;);</span>
<span class="fc" id="L191">		ArrayList&lt;Investment&gt; investments = new ArrayList&lt;Investment&gt;();</span>
		
		//Populate the list with the JSON array values
<span class="fc bfc" id="L194" title="All 2 branches covered.">		for (int i = 0; i != jArrayInvestments.length(); ++i) {</span>
<span class="fc" id="L195">			investments.add(new Investment(jArrayInvestments.getJSONObject(i)));</span>
		}

		//Get the list that is included in the JSON file
<span class="fc" id="L199">		JSONArray jArrayBuildings = jsonObject.getJSONArray(&quot;Buildings&quot;);</span>
<span class="fc" id="L200">		ArrayList&lt;Building&gt; buildings = new ArrayList&lt;Building&gt;();</span>
		
		//Populate the list with the JSON array values
<span class="pc bpc" id="L203" title="1 of 2 branches missed.">		for (int i = 0; i != jArrayBuildings.length(); ++i) {</span>
<span class="nc" id="L204">			buildings.add(new Building(jArrayBuildings.getJSONObject(i)));</span>
		}
		
		//Set the class values to what the JSON file produced
<span class="fc" id="L208">		this.points = points;</span>
<span class="fc" id="L209">		this.money = money;</span>
<span class="fc" id="L210">		this.name = name;</span>
<span class="fc" id="L211">		this.assets = assets;</span>
<span class="fc" id="L212">		this.employees = employees;</span>
<span class="fc" id="L213">		this.investments = investments;</span>
<span class="fc" id="L214">		this.buildings = buildings;</span>
<span class="fc" id="L215">	}</span>
	
	/**
	 * Initializes Player class based off JSON data
	 * @param playerName
	 */
	public boolean readFile(String playerName) {
		try {
<span class="fc" id="L223">			JSONTokener tokener = new JSONTokener(new FileReader(getJSONFilePath(playerName)));</span>
			//Read the file and store it in a json object
<span class="fc" id="L225">			JSONObject jsonObject = new JSONObject(tokener);</span>
			
			// Set all the member variables.
<span class="fc" id="L228">			this.setFromJSONObject(jsonObject);</span>
<span class="fc" id="L229">			return true;</span>
<span class="fc" id="L230">		} catch (Exception e) {</span>
<span class="fc" id="L231">			System.out.println(&quot;Failed to read.&quot;);</span>
		}
<span class="fc" id="L233">		return false;</span>
	}
	
	/**
	 * Adds an asset to the list
	 * @param str
	 */
	public void addAsset(String str) {
<span class="fc" id="L241">		assets.add(str);</span>
<span class="fc" id="L242">	}</span>
	
	/**
	 * Adds an investment to the list
	 */
	public void addInvestment(Investment inv) {
<span class="fc" id="L248">		investments.add(inv);</span>
<span class="fc" id="L249">	}</span>
	
	/**
	 * Removes an asset from the list
	 * @param str
	 */

	public void removeAsset(String str) {
<span class="nc bnc" id="L257" title="All 2 branches missed.">		for (int i = 0; i &lt; assets.size(); i++) {</span>
<span class="nc bnc" id="L258" title="All 2 branches missed.">			if (assets.get(i).equals(str)) {</span>
<span class="nc" id="L259">				assets.remove(i);</span>
<span class="nc" id="L260">				i -= 1;</span>
			}
		}
<span class="nc" id="L263">	}</span>
	
	/**
	 * Removes an investment from the list
	 */
	public void removeInvestment(Investment inv) {
<span class="nc bnc" id="L269" title="All 2 branches missed.">		for (int i = 0; i &lt; investments.size(); ++i) {</span>
<span class="nc bnc" id="L270" title="All 2 branches missed.">			if (investments.get(i).equals(inv)) {</span>
<span class="nc" id="L271">				investments.remove(i);</span>
<span class="nc" id="L272">				i -= 1;</span>
			}
		}
<span class="nc" id="L275">	}</span>
	/**
	 * @return points
	 */
	public int getPoints() {
<span class="fc" id="L280">		return points;</span>
	}
	/**
	 * @param points
	 */
	public void setPoints(int points) {
<span class="fc" id="L286">		this.points = points;</span>
<span class="fc" id="L287">	}</span>
	/**
	 * @param add
	 */
	public void addPoints(int points) {
<span class="nc" id="L292">		this.points += points;</span>
<span class="nc" id="L293">	}</span>
	/**
	 * @return money
	 */
	public double getMoney() {
<span class="fc" id="L298">		return money;</span>
	}
	/**
	 * @param money
	 */
	public void setMoney(double money) {
<span class="fc" id="L304">		this.money = money;</span>
<span class="fc" id="L305">	}	</span>
	/**
	 * @param money
	 */
	public void addMoney(double money) {
<span class="nc" id="L310">		this.money += money;</span>
<span class="nc" id="L311">	}</span>
	/**
	 * @return name
	 */
	public String getName() {
<span class="fc" id="L316">		return name;</span>
	}
	/**
	 * @param name
	 */
	public void setName(String name) {
<span class="fc" id="L322">		this.name = name;</span>
<span class="fc" id="L323">	}</span>
	/**
	 * @return employees
	 */
	public int getEmployees() {
<span class="nc" id="L328">		return employees;</span>
	}
	/**
	 * @param employees
	 */
	public void setEmployees(int employees) {
<span class="fc" id="L334">		this.employees = employees;</span>
<span class="fc" id="L335">	}</span>
	/**
	 * @param employees
	 */
	public void addEmployees(int employees) {
<span class="nc" id="L340">		this.employees += employees;</span>
<span class="nc" id="L341">	}</span>
	/**
	 * @return assets
	 */
	public ArrayList&lt;String&gt; getAssets() {
<span class="fc" id="L346">		return assets;</span>
	}
	
	/**
	 * @return investments
	 */

	public ArrayList&lt;Investment&gt; getInvestments() {
<span class="fc" id="L354">		return investments;</span>
	}
	
	/**
	 * Takes in a List and populates the assets list, without 
	 * replacing any data.
	 * @param assets
	 */
	public void addAssets(List&lt;String&gt; assets) {
<span class="nc bnc" id="L363" title="All 2 branches missed.">		for (String asset : assets) {</span>
<span class="nc" id="L364">			this.assets.add(asset);</span>
		}
<span class="nc" id="L366">	}</span>
	
	/**
	 * Takes in a List and populates the assets list, without
	 * replacing any data
	 * @param investments
	 */
	public void addInvestments(List&lt;Investment&gt; investments) {
<span class="nc bnc" id="L374" title="All 2 branches missed.">		for (Investment investment : investments) {</span>
<span class="nc" id="L375">			this.investments.add(investment);</span>
		}
<span class="nc" id="L377">	}</span>
	
	/**
	 * Takes in a List and replaces the current player list with the new one.
	 * @param assets
	 */
	public void setAssets(List&lt;String&gt; assets) {
<span class="fc" id="L384">		this.assets = new ArrayList&lt;String&gt;(assets);</span>
<span class="fc" id="L385">	}</span>
	
	/**
	 * Takes in a List and replaces the current player list with the new one.
	 * @param investments
	 */
	public void setInvestments(List&lt;Investment&gt; investments) {
<span class="nc" id="L392">		this.investments = new ArrayList&lt;Investment&gt;(investments);</span>
<span class="nc" id="L393">	}</span>
	
	/**
	 * Create an investment, removing the money put into it.
	 * @param name    Name of the investment
	 * @param amount  Amount invested
	 * @param isGood  Secret flag; good or bad investment
	 */
	public void takeInvestment(String name, double amount, boolean isGood) {
<span class="fc" id="L402">		Investment inv = new Investment(name, amount, isGood);</span>
<span class="fc" id="L403">		this.money -= amount;</span>
<span class="fc" id="L404">		this.addInvestment(inv);</span>
<span class="fc" id="L405">	}</span>
	
	/**
	 * Cash out on an investment.
	 * @param inv  Investment to take a return from.
	 */
	public void cashInvestment(Investment inv) {
<span class="fc" id="L412">		this.money += inv.calculateROI();</span>
<span class="fc" id="L413">	}</span>
	
	public Product getProduct() {
<span class="nc" id="L416">		return this.product;</span>
	}
	
	public void setProduct(Product product) {
<span class="nc" id="L420">		this.product = product;</span>
<span class="nc" id="L421">	}</span>
	
	public List&lt;Building&gt; getBuildings() {
<span class="fc" id="L424">		return buildings;</span>
	}
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.2.201409121644</span></div></body></html>