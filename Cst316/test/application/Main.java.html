<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>Main.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Cst316</a> &gt; <a href="index.source.html" class="el_package">application</a> &gt; <span class="el_source">Main.java</span></div><h1>Main.java</h1><pre class="source lang-java linenums">package application;

import java.io.InputStream;

import service.TimedEventService;
import cst316.Management;
import cst316.Player;
import javafx.application.Application;
import javafx.fxml.FXMLLoader;
import javafx.fxml.JavaFXBuilderFactory;
import javafx.stage.Stage;
import javafx.scene.Node;
import javafx.scene.Scene;
import javafx.scene.layout.AnchorPane;
import javafx.scene.layout.BorderPane;

<span class="fc" id="L17">public class Main extends Application {</span>

    private Stage stage;
    private Scene scene;
<span class="fc" id="L21">    private final double MINIMUM_WINDOW_WIDTH = 1280;</span>
<span class="fc" id="L22">    private final double MINIMUM_WINDOW_HEIGHT = 720;</span>
    private Player player;

    @Override
    public void start(Stage primaryStage) {
        try {
            // This will need to be redone, really badly!
<span class="nc" id="L29">            Management management = new Management();</span>
<span class="nc" id="L30">            management.getClass();</span>
<span class="nc" id="L31">            BorderPane root = new BorderPane();</span>
<span class="nc" id="L32">            stage = primaryStage;</span>
<span class="nc" id="L33">            scene = new Scene(root, 400, 400);</span>
<span class="nc" id="L34">            scene.getStylesheets().add(getClass().getResource(&quot;application.css&quot;).toExternalForm());</span>
<span class="nc" id="L35">            stage.setMinWidth(MINIMUM_WINDOW_WIDTH);</span>
<span class="nc" id="L36">            stage.setMinHeight(MINIMUM_WINDOW_HEIGHT);</span>
<span class="nc" id="L37">            stage.setScene(scene);</span>
<span class="nc" id="L38">            stage.show();</span>

<span class="nc" id="L40">            LoginController ctr = (LoginController) replaceSceneContent(&quot;Login.fxml&quot;, null);</span>
            
<span class="nc" id="L42">            ctr.setApp(this);</span>
            
<span class="nc" id="L44">        } catch (Exception e) {</span>
<span class="nc" id="L45">            e.printStackTrace();</span>
        }
<span class="nc" id="L47">    }</span>

    public static void main(String[] args) {
<span class="nc" id="L50">        launch(args);</span>
<span class="nc" id="L51">    }</span>

    public Stage getStage() {
<span class="nc" id="L54">        return stage;</span>
    }

    public void setPlayer(Player player) {
<span class="nc" id="L58">        this.player = player;</span>
<span class="nc" id="L59">    }</span>

    public Player getPlayer() {
<span class="fc" id="L62">        return player;</span>
    }

    // A lot of this was taken from the Oracle JFX samples, changes will be made
    public Node replaceSceneContent(String fxml, Class&lt;? extends AnchorPane&gt; cls) throws Exception {
<span class="nc" id="L67">        FXMLLoader loader = new FXMLLoader();</span>
<span class="nc bnc" id="L68" title="All 2 branches missed.">        if (cls == null) {</span>
<span class="nc" id="L69">            System.out.println(&quot;controlller was set by FXML&quot;);</span>
<span class="nc" id="L70">        } else {</span>
<span class="nc" id="L71">            loader.setController(cls.getConstructor().newInstance()); //set controller manually</span>
        }
<span class="nc" id="L73">        InputStream in = Main.class.getResourceAsStream(fxml);</span>
<span class="nc" id="L74">        loader.setBuilderFactory(new JavaFXBuilderFactory());</span>
<span class="nc" id="L75">        loader.setLocation(Main.class.getResource(fxml));</span>
        AnchorPane page;
        try {
<span class="nc" id="L78">            page = (AnchorPane) loader.load(in);</span>
<span class="nc" id="L79">        } finally {</span>
<span class="nc" id="L80">            in.close();</span>
<span class="nc" id="L81">        }</span>

        // Store the stage width and height in case the user has resized the window
<span class="nc" id="L84">        double stageWidth = stage.getWidth();</span>
<span class="nc bnc" id="L85" title="All 2 branches missed.">        if (!Double.isNaN(stageWidth)) {</span>
<span class="nc" id="L86">            stageWidth -= (stage.getWidth() - stage.getScene().getWidth());</span>
        }

<span class="nc" id="L89">        double stageHeight = stage.getHeight();</span>
<span class="nc bnc" id="L90" title="All 2 branches missed.">        if (!Double.isNaN(stageHeight)) {</span>
<span class="nc" id="L91">            stageHeight -= (stage.getHeight() - stage.getScene().getHeight());</span>
        }

<span class="nc" id="L94">        Scene scene = new Scene(page);</span>
<span class="nc bnc" id="L95" title="All 2 branches missed.">        if (!Double.isNaN(stageWidth)) {</span>
<span class="nc" id="L96">            page.setPrefWidth(stageWidth);</span>
        }
<span class="nc bnc" id="L98" title="All 2 branches missed.">        if (!Double.isNaN(stageHeight)) {</span>
<span class="nc" id="L99">            page.setPrefHeight(stageHeight);</span>
        }

<span class="nc" id="L102">        stage.setScene(scene);</span>
<span class="nc" id="L103">        stage.sizeToScene();</span>
<span class="nc" id="L104">        return (Node) loader.getController();</span>
    }

    /**
     * If the provided class has been loaded from a jar file that is on the
     * local file system, will find the absolute path to that jar file. Stolen
     * from:
     * http://stackoverflow.com/questions/1983839/determine-which-jar-file-a-class-is-from
     *
     * @param context The jar file that contained the class file that represents
     * this class will be found. Specify {@code null} to let
     * {@code LiveInjector} find its own jar.
     * @throws IllegalStateException If the specified class was loaded from a
     * directory or in some other way (such as via HTTP, from a database, or
     * some other custom classloading device).
     */
    public static String findPathJar(Class&lt;?&gt; context, String resource) throws IllegalStateException {
<span class="pc bpc" id="L121" title="1 of 2 branches missed.">        if (context == null) {</span>
<span class="nc" id="L122">            context = Main.class;</span>
        }
<span class="fc" id="L124">        String rawName = context.getName();</span>
        String classFileName;
        /* rawName is something like package.name.ContainingClass$ClassName. We need to turn this into ContainingClass$ClassName.class. */ {
<span class="fc" id="L127">            int idx = rawName.lastIndexOf('.');</span>
<span class="pc bpc" id="L128" title="1 of 2 branches missed.">            classFileName = (idx == -1 ? rawName : rawName.substring(idx + 1)) + &quot;.class&quot;;</span>
        }

<span class="fc" id="L131">        String uri = context.getResource(classFileName).toString();</span>
<span class="pc bpc" id="L132" title="1 of 2 branches missed.">        if (uri.startsWith(&quot;file:&quot;)) {</span>
<span class="nc" id="L133">            throw new IllegalStateException(&quot;This class has been loaded from a directory and not from a jar file.&quot;);</span>
        }
<span class="pc bpc" id="L135" title="1 of 2 branches missed.">        if (!uri.startsWith(&quot;jar:file:&quot;)) {</span>
<span class="nc" id="L136">            int idx = uri.indexOf(':');</span>
<span class="nc bnc" id="L137" title="All 2 branches missed.">            String protocol = idx == -1 ? &quot;(unknown)&quot; : uri.substring(0, idx);</span>
<span class="nc" id="L138">            throw new IllegalStateException(&quot;This class has been loaded remotely via the &quot; + protocol</span>
<span class="nc" id="L139">                    + &quot; protocol. Only loading from a jar on the local file system is supported.&quot;);</span>
        }

<span class="fc" id="L142">        int idx = uri.indexOf('!');</span>
        //As far as I know, the if statement below can't ever trigger, so it's more of a sanity check thing.
<span class="pc bpc" id="L144" title="1 of 2 branches missed.">        if (idx == -1) {</span>
<span class="nc" id="L145">            throw new IllegalStateException(&quot;You appear to have loaded this class from a local jar file, but I can't make sense of the URL!&quot;);</span>
        }

<span class="fc" id="L148">        return uri.substring(0, idx) + &quot;!&quot; + resource;</span>
    }
}

</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.2.201409121644</span></div></body></html>